import pandas as pd
import usecase.df_extension as df_extension
import usecase.staff_extension as staff_extension
import configparser

def read_ini_config(filepath):
    config = configparser.ConfigParser()
    config.read(filepath)
    return config

config_data = read_ini_config('config.txt')

excel_file = config_data['base']['excelFile']
sheetIndex = int(config_data['base']['sheetIndex'])

df = pd.read_excel(excel_file, sheet_name=sheetIndex)
clen_df = df_extension.clean_data(df)
staffs = staff_extension.create_staffs(clen_df)
scheduleList = staff_extension.get_schedule_list(staffs)

# print(df_extension.clean_data(df))
print(scheduleList)
for s in staffs:
	print(s.__dict__)
